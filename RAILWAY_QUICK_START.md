# Emotional Journal - Railway Deployment Quick Start

## GitHub Repository

**Repository URL:** https://github.com/orlengos-star/emotional-journal

**Clone Command:**
```bash
git clone https://github.com/orlengos-star/emotional-journal.git
cd emotional-journal
```

---

## Railway Deployment in 5 Steps

### Step 1: Create New Project on Railway

1. Go to [railway.app](https://railway.app)
2. Sign in to your Railway account
3. Click **"New Project"**
4. Select **"Deploy from GitHub"**

### Step 2: Connect GitHub Repository

1. Click **"GitHub"** as the source
2. Authorize Railway to access your GitHub account
3. Select **"orlengos-star/emotional-journal"** repository
4. Click **"Deploy"**

Railway will automatically detect the Node.js project and start building.

### Step 3: Add PostgreSQL Database

While the app is building:

1. In the Railway project, click **"Add Service"**
2. Select **"PostgreSQL"**
3. Railway creates the database automatically
4. **Copy the DATABASE_URL** that appears in the PostgreSQL service variables

### Step 4: Set Environment Variables

In your Node.js service, go to **"Variables"** and add:

```
BOT_TOKEN=8487391500:AAFJ6FyBecjkGTy9hbeyb5ehy7FgDVpY4jA
NODE_ENV=production
PORT=3000
DATABASE_URL=<paste-from-postgresql-service>
JWT_SECRET=<generate-below>
```

**Generate JWT_SECRET:**
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

Or use any random 32-character string.

### Step 5: Deploy

1. Verify the build completed successfully
2. Check the "Deployments" tab
3. Once deployed, click on the service to get your **public URL**
4. Format: `https://emotional-journal-production-xxxx.railway.app`

---

## Environment Variables Reference

| Variable | Required | Value |
|----------|----------|-------|
| `BOT_TOKEN` | ✅ | `8487391500:AAFJ6FyBecjkGTy9hbeyb5ehy7FgDVpY4jA` |
| `NODE_ENV` | ✅ | `production` |
| `PORT` | ✅ | `3000` |
| `DATABASE_URL` | ✅ | Auto-generated by PostgreSQL service |
| `JWT_SECRET` | ✅ | Random 32-char string (generate above) |
| `VITE_APP_ID` | ❌ | Manus OAuth app ID (optional) |
| `OAUTH_SERVER_URL` | ❌ | `https://api.manus.im` (optional) |
| `VITE_OAUTH_PORTAL_URL` | ❌ | Manus portal URL (optional) |
| `VITE_FRONTEND_FORGE_API_URL` | ❌ | Manus API URL (optional) |
| `VITE_FRONTEND_FORGE_API_KEY` | ❌ | Manus API key (optional) |
| `BUILT_IN_FORGE_API_URL` | ❌ | Manus API URL (optional) |
| `BUILT_IN_FORGE_API_KEY` | ❌ | Manus API key (optional) |
| `OWNER_OPEN_ID` | ❌ | Your ID (optional) |
| `OWNER_NAME` | ❌ | Your name (optional) |

**Note:** Only the first 5 variables are required for basic functionality. The Manus OAuth variables are optional if you want to use Manus authentication.

---

## What Happens During Deployment

Railway will:

1. **Clone** the repository from GitHub
2. **Install** dependencies with `pnpm install`
3. **Build** the frontend with Vite
4. **Bundle** the backend with esbuild
5. **Start** the server with `pnpm start`
6. **Initialize** the Telegram bot
7. **Start** background notification jobs
8. **Create** database tables

All automatically!

---

## Testing After Deployment

### 1. Test Frontend
- Visit your Railway URL
- Verify the React Mini App loads
- Check the Scandinavian design is visible

### 2. Test Telegram Bot
- Send a message to your Telegram bot: `@emotional_journal_bot` (or your bot name)
- Bot should respond: "Saved for today, [date]"
- Click "View" button to open the Mini App

### 3. Test Database
- Create an entry via the bot
- Verify it appears in the Mini App
- Try editing the entry

### 4. Test Notifications
- Configure notification settings in the app
- Wait for daily reminder (or test manually)

---

## Viewing Logs

In the Railway dashboard:

1. Go to your Node.js service
2. Click **"Logs"** tab
3. View real-time logs

**Look for:**
```
Server running on http://localhost:3000/
Telegram bot initialized
Notification jobs started
Database connection successful
```

---

## Troubleshooting

### Build Failed

**Error:** `pnpm: command not found`

**Solution:** Railway should auto-detect pnpm. If not, add to build command:
```
npm install -g pnpm && pnpm install && pnpm build
```

### Database Connection Error

**Error:** `DATABASE_URL not set` or connection refused

**Solution:**
1. Verify PostgreSQL service is added
2. Check DATABASE_URL is set in variables
3. Ensure PostgreSQL service is running

### Bot Not Responding

**Error:** Bot doesn't respond to messages

**Solution:**
1. Verify BOT_TOKEN is correct
2. Check logs for errors
3. Ensure Telegram API is accessible

### Port Already in Use

**Error:** `EADDRINUSE: address already in use :::3000`

**Solution:** Railway handles port allocation automatically. This shouldn't happen on Railway.

---

## Project Structure

```
emotional-journal/
├── client/                 # React frontend
│   ├── src/
│   │   ├── pages/         # Page components
│   │   ├── components/    # Reusable components
│   │   ├── App.tsx        # Main app
│   │   └── index.css      # Styles
│   └── dist/              # Built frontend
├── server/                 # Node.js backend
│   ├── _core/
│   │   └── index.ts       # Express server
│   ├── telegram-bot.ts    # Bot handler
│   ├── routers.ts         # tRPC endpoints
│   └── db.ts              # Database helpers
├── drizzle/               # Database schema
│   └── schema.ts          # Table definitions
├── Dockerfile             # Docker configuration
├── package.json           # Dependencies
├── vite.config.ts         # Vite config
└── vercel.json            # Deployment config
```

---

## Features Included

✅ **Telegram Bot**
- Saves user messages as journal entries
- Sends "View" button to open Mini App
- Responds with confirmation message

✅ **React Mini App**
- Client view: Browse entries by month
- Therapist view: Manage clients
- Day rating system (5-point scale)
- Entry editing and creation

✅ **Database**
- 7 tables with full relationships
- User management
- Entry storage
- Day ratings
- Client-therapist connections
- Notification settings

✅ **Notifications**
- Daily reminders
- Per-client alerts
- Batch digest mode
- Therapy-friendly messaging

✅ **Design**
- Scandinavian aesthetic
- Pale gray background
- Soft blue and blush pink accents
- Clean, minimal UI

---

## Next Steps

1. ✅ **GitHub Repository Created** — https://github.com/orlengos-star/emotional-journal
2. ⏭️ **Deploy to Railway** — Follow the 5 steps above
3. ⏭️ **Set Environment Variables** — Add BOT_TOKEN and others
4. ⏭️ **Test Features** — Verify bot, frontend, and database work
5. ⏭️ **Share URL** — Send the public Railway URL to users

---

## Support

- **Railway Docs:** [docs.railway.app](https://docs.railway.app)
- **GitHub Repo:** [github.com/orlengos-star/emotional-journal](https://github.com/orlengos-star/emotional-journal)
- **Telegram Bot:** [@emotional_journal_bot](https://t.me/emotional_journal_bot)

---

## Summary

Your Emotional Journal app is ready to deploy! The source code is on GitHub, and you can deploy to Railway in just 5 steps. All features are included:

- ✅ Telegram bot with message journaling
- ✅ React Mini App for clients and therapists
- ✅ Day rating system
- ✅ Client-therapist connections
- ✅ Notification system
- ✅ Scandinavian design
- ✅ Full database with migrations

Just follow the 5 steps above and you'll have a fully functional therapy support app running on Railway!
